#***************************************************************
# Script generation configuration file. 
# Generate's basic job scripts from templates
# 
# Environment variables can be accessed using $(var) syntax
# Local variables defined elswhere in this configuration file can be 
# accessed using %(var) syntax.  If the variable inside $() or %() 
# is not defined within the current environment, it will not be expanded.
#
# Due to the syntax of yaml, entries cannot begin with %; 
# to start an entry with a local variable reference, enclose 
# the entry in quotation marks, see examples below.
# 
# Although the file is nominally divided into sections by comments,
# logically it is a single dictionary 
#
#***************************************************************


#************************************************
# Logging
#************************************************
log.name          : generate                               # name of logger object
log.level         : DEBUG                                  # log level to write to file   
log.file          : "%(base-dir)/generate.log"             # file to write to
log.fmt           : "%(message)s"                          # see logging module for format codes
log.mail          : false                                  # send an email of log
log.mail.to       : sam.hawkins@vattenfall.com
log.mail.level    : INFO                                   # level to mail
log.mail.buffer   : 100000                                 # maximum number of lines in one email

#************************************************
# Directory locations  
#************************************************
wrftools-dir      : $(HOME)/code/wrftools/devel
template-dir      : "%(wrftools-dir)/templates"                 # location of script templates
base-dir          : $(HOME)/forecasting/test                    
target-dir        : "%(base-dir)/scripts"                       # create job scripts here
queue             : all.q

jobs:
    1: 
        template : "%(template-dir)/template_mpi.sge"
        target   : "%(target-dir)/ungrib/ungrib.sh"
        replacements: 
            <jobname>    : ungrib
            <cmd> : ungrib.exe
            <nprocs>     : 1
            <queue>      : "%(queue)"
            <logfile>    : "ungrib.log"

    2: 
        template : "%(template-dir)/template_serial.sge"
        target   : "%(target-dir)/ungrib/ungrib.post.sh"
        replacements: 
            <jobname>    : ungrib.post
            <cmd>        : "mv ???\\:* ../metgrid"
            <nprocs>     : 1
            <queue>      : "%(queue)"
            <logfile>    : "ungrib.post.log"
            
            
    3: 
        template : "%(template-dir)/template_mpi.sge"
        target   : "%(target-dir)/ungrib_sst/ungrib.sh"
        replacements: 
            <jobname>    : ungrib_sst
            <cmd>        : ungrib.exe
            <nprocs>     : 1
            <queue>      : "%(queue)"
            <logfile>    : "ungrib.log"            

    4: 
        template : "%(template-dir)/template_mpi.sge"
        target   : "%(target-dir)/ungrib_sst/ungrib.sh"
        replacements: 
            <jobname>    : ungrib_sst
            <cmd>        : ungrib.exe
            <nprocs>     : 1
            <queue>      : "%(queue)"
            <logfile>    : "ungrib.log"            
            
    5: 
        template : "%(template-dir)/template_serial.sge"
        target   : "%(target-dir)/ungrib_sst/ungrib_sst.post.sh"
        replacements: 
            <jobname>    : ungrib_sst.post
            <nprocs>     : 1
            <queue>      : "%(queue)"
            <logfile>    : "ungrib.post.log"


            
    6: 
        template : "%(template-dir)/template_mpi.sge"
        target   : "%(target-dir)/metgrid/metgrid.sh"
        replacements: 
            <jobname>    : metgrid
            <cmd>        : metgrid.exe
            <nprocs>     : 1
            <queue>      : "%(queue)"
            <logfile>    : "metgrid.log"            

    7: 
        template : "%(template-dir)/template_mpi.sge"
        target   : "%(target-dir)/wrf/real.sh"
        replacements: 
            <jobname>    : real
            <cmd>        : real.exe
            <nprocs>     : 1
            <queue>      : "%(queue)"
            <logfile>    : "real.log"            

    8: 
        template : "%(template-dir)/template_mpi.sge"
        target   : "%(target-dir)/wrf/wrf.sh"
        replacements: 
            <jobname>    : wrf
            <cmd>        : wrf.exe
            <nprocs>     : 40
            <queue>      : "%(queue)"
            <logfile>    : "wrf.log"
            
    9: 
        template : "%(template-dir)/wrf/wrf.post.sh"
        target   : "%(target-dir)/wrf/wrf.post.sh"


    10: 
        template : "%(template-dir)/ncl/ncl.sh"
        target   : "%(target-dir)/ncl/ncl.sh"
            
